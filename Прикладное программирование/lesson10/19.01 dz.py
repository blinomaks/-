import pandas as pd
import io

def print_section(title):
    print(f"\n {title.upper()}")
    print("=" * 40)

# –®–ê–ì 2: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

hospital_data = {
    'episode_id': [101, 102, 103, 104, 105, 106, 107, 108, 109, 110],
    'patient_name': ['–ò–≤–∞–Ω–æ–≤ –ò.–ò.', '–ü–µ—Ç—Ä–æ–≤ –ü.–ü.', '–°–∏–¥–æ—Ä–æ–≤–∞ –ê.–ê.', '–ö—É–∑–Ω–µ—Ü–æ–≤ –ö.–ö.', '–°–º–∏—Ä–Ω–æ–≤–∞ –ï.–ï.', 
                     '–ü–æ–ø–æ–≤ –î.–î.', '–í–∞—Å–∏–ª—å–µ–≤ –í.–í.', '–ú–∞–∫–∞—Ä–æ–≤–∞ –ú.–ú.', '–õ–µ–±–µ–¥–µ–≤ –õ.–õ.', '–ú–æ—Ä–æ–∑–æ–≤–∞ –ù.–ù.'],
    'age': [35, 62, 45, 70, 28, 65, 50, 81, 40, 68],
    'diagnosis': ['–ì—Ä–∏–ø–ø', '–ì–∏–ø–µ—Ä—Ç–æ–Ω–∏—è', '–ì–∞—Å—Ç—Ä–∏—Ç', '–î–∏–∞–±–µ—Ç', '–û–†–í–ò', 
                  '–ì–∏–ø–µ—Ä—Ç–æ–Ω–∏—è', '–ë—Ä–æ–Ω—Ö–∏—Ç', '–ê—Ä—Ç—Ä–∏—Ç', '–ì—Ä–∏–ø–ø', '–î–∏–∞–±–µ—Ç'],
    'doctor': ['–î—Ä. –•–∞—É—Å', '–î—Ä. –í–∞—Ç—Å–æ–Ω', '–î—Ä. –ê–π–±–æ–ª–∏—Ç', '–î—Ä. –í–∞—Ç—Å–æ–Ω', '–î—Ä. –•–∞—É—Å', 
               '–î—Ä. –°—Ç—Ä—ç–Ω–¥–∂', '–î—Ä. –ê–π–±–æ–ª–∏—Ç', '–î—Ä. –°—Ç—Ä—ç–Ω–¥–∂', '–î—Ä. –•–∞—É—Å', '–î—Ä. –í–∞—Ç—Å–æ–Ω'],
    'outcome': ['–í—ã–∑–¥–æ—Ä–æ–≤–ª–µ–Ω–∏–µ', '–°—Ç–∞–±–∏–ª—å–Ω–æ', '–õ–µ—á–µ–Ω–∏–µ', '–°—Ç–∞–±–∏–ª—å–Ω–æ', '–í—ã–∑–¥–æ—Ä–æ–≤–ª–µ–Ω–∏–µ', 
                '–£—Ö—É–¥—à–µ–Ω–∏–µ', '–í—ã–∑–¥–æ—Ä–æ–≤–ª–µ–Ω–∏–µ', '–°—Ç–∞–±–∏–ª—å–Ω–æ', '–í—ã–∑–¥–æ—Ä–æ–≤–ª–µ–Ω–∏–µ', '–õ–µ—á–µ–Ω–∏–µ']
}

df = pd.DataFrame(hospital_data)

# –®–ê–ì 3

print_section("–ü–µ—Ä–≤—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç—ã –≤ —Å–ø–∏—Å–∫–µ")
print(df.head())

print_section("–†–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö")
rows, cols = df.shape
print(f"–ó–∞–ø–∏—Å–µ–π: {rows}, –ö–æ–ª–æ–Ω–æ–∫: {cols}")

print_section("–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ—à–∏–±–∫–∏ (–ø—Ä–æ–ø—É—Å–∫–∏)")
print(df.isna().sum()) 

# –®–ê–ì 4

df = df.set_index('episode_id')

print_section("–ù–æ–≤—ã–π –≤–∏–¥ —Ç–∞–±–ª–∏—Ü—ã (–∏–Ω–¥–µ–∫—Å = ID —Å–ª—É—á–∞—è)")
print(df.head(3))

df = df.reset_index().set_index('episode_id')

# –®–ê–ì 5

print_section("–ü–æ–∏—Å–∫: –°–∏–¥–æ—Ä–æ–≤–∞ –ê.–ê.")
print(df.query("patient_name == '–°–∏–¥–æ—Ä–æ–≤–∞ –ê.–ê.'"))

print_section("–î–∏–∞–≥–Ω–æ–∑: –ì–∏–ø–µ—Ä—Ç–æ–Ω–∏—è")
print(df.query("diagnosis == '–ì–∏–ø–µ—Ä—Ç–æ–Ω–∏—è'"))

print_section("–ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–∞: –°—Ç–∞—Ä—à–µ 60 –ª–µ—Ç")
print(df.query("age > 60"))

print_section("–¢–æ—á–µ—á–Ω—ã–π –ø–æ–∏—Å–∫")
print("üëâ –ü–æ ID 102 (loc):")
print(df.loc[102]) 
print("\nüëâ –ü–æ –Ω–æ–º–µ—Ä—É —Å—Ç—Ä–æ–∫–∏ 1 (iloc):")
print(df.iloc[1])

# –®–ê–ì 6

new_patients_csv = """episode_id,patient_name,age,diagnosis,doctor,outcome
201,–ó–∞–π—Ü–µ–≤ –ó.–ó.,33,–ü–µ—Ä–µ–ª–æ–º,–î—Ä. –°—Ç—Ä—ç–Ω–¥–∂,–í—ã–∑–¥–æ—Ä–æ–≤–ª–µ–Ω–∏–µ
202,–í–æ–ª–∫–æ–≤ –í.–í.,44,–£—à–∏–±,–î—Ä. –•–∞—É—Å,–í—ã–∑–¥–æ—Ä–æ–≤–ª–µ–Ω–∏–µ
203,–õ–∏—Å–∏—Ü—ã–Ω–∞ –õ.–õ.,25,–ì–∞—Å—Ç—Ä–∏—Ç,–î—Ä. –ê–π–±–æ–ª–∏—Ç,–õ–µ—á–µ–Ω–∏–µ
"""

df_new = pd.read_csv(io.StringIO(new_patients_csv)).set_index('episode_id')

print_section("–ó–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑ CSV")
print(df_new)